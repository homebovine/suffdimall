
datasrd = load('datasrdrealfull.tab');
pini = 0;
n1 = size(datasrd, 1);
p = size(datasrd, 2) - 1;
%load('betahat0.mat')
mx0 = zeros(n1/2,p,  100);
my0 = zeros(n1/2, 100);
mnewx = zeros(n1/2, p,  100); 
mnewy = zeros(n1/2, 100); 
for itr = 1:1
[datasrd0, ind] = datasample(datasrd, (n1)/2, 'Replace', false); 
%ind = randi(n1, n1, 1);
ind = 1:n1; % 1:((n1 + 1)/2);
y0 = datasrd(ind, 1);
x0 = datasrd(ind, 2:(p+ 1));
datasrd1 =datasrd(setdiff(1:size(datasrd, 1),ind), :);
newy = datasrd1(:, 1);
newx = datasrd1(:, 2:(p + 1));
n = size(y0, 1);% (n1 + 1)/2
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%                                                                         %
%                                                                         %
%                             DIRECTIONAL  REGRESSION                     %
%                                                                         %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
x = x0; y = y0; dim = 4;
ss = cov(x,0); mu = mean(x);
z = (x - ones(n,1)*mu)*(inv(ss))^(1/2);
%beta0 =[1,5.310006e-01,1.696626e-01,5.752374e-01,3.704519e-01,-1.883053e-01];% [1,2.198969e-01,1.255190e+00,1.014425e+00,-2.727293e-01,-1.231710e-01];% [1,5.443134e-01,5.776732e-01,7.712757e-01,5.739989e-01,-5.448373e-01];
beta0 = -2.5 * ones(p, 10); %; %0.65 * ones(p, p); %
%beta0 = repmat((beta0)', 1, p);%0.25 * ones(p, p); %;
%
%betapre = reshape([1, -0.07742569, 0.13349864, 0.01701365, 0.13228325, -0.13818912, -0.06092542, 0.11662245, -0.08878898,  0.02639284,  1,0,-3.518526e-01,5.675825e-01,-7.373274e-01,3.992877e-01,-6.935311e-01,3.326416e-01,9.296642e-01,-3.521803e-01,-1.110223e-16,1,-4.733024e-01,-6.627100e-01,-2.010747e+00,1.974737e+00,1.209540e-01,-2.303701e-01,2.189896e+00,1.384404e+00, 1,1.110223e-16,1.387779e-16,8.898427e-01,1.242062e-01,-3.122134e-01,-5.780759e-01,2.421343e-01,9.906535e-02,-1.046225e+00,-8.326673e-17,1,0,-2.292145e-01,-8.518355e-01,1.017645e+00,2.762612e-01,-3.521180e-01,1.072597e+00,4.507937e-01,5.551115e-17,0,1,9.158954e-01,2.448564e+00,-2.022157e+00,3.281351e-01,-2.572306e-01,-2.360644e+00,-1.972544e+00, 1.000000e+00,-2.775558e-16,4.440892e-16,5.637851e-17,-2.552556e+00,1.597112e+00,-3.100726e+00,2.226718e+00,5.837207e+00,2.474428e+00,1.387779e-16,1,-1.665335e-16,-4.380177e-17,-1.623283e-01,5.258219e-01,9.260704e-01,-8.633269e-01,-4.054908e-01,-4.560911e-01,-2.220446e-16,-1.665335e-16,1.000000e+00,1.361758e-16,-3.065682e-01,-5.693002e-02,-2.268373e+00,1.785458e+00,3.545498e+00,1.651186e+00,3.330669e-16,2.220446e-16,0,1.000000e+00,3.008130e+00,-2.145689e+00,2.834939e+00,-2.230264e+00,-6.448490e+00,-3.956489e+00], 10, 10)
%betapre = reshape([1,-5.899607e-001,-1.204012e-001,9.499054e-001,4.026384e-002,4.620538e-001,-8.904199e-002,2.234673e+000,-1.008204e+000,-5.370786e-001,-2.261315e-001,...
%    1,0,-8.772833e-001,1.339453e+000,2.601260e+000,1.714380e+000,9.433516e-001,4.629220e+000,-7.967127e+000,3.658197e+000,1.464618e-001,2.775558e-017,1.000000e+000,-4.294185e-002,1.919141e-001,1.396339e+000,7.528546e-001,5.324352e-001,2.562219e-001,-2.552268e+000,2.731990e+000,7.135875e-001, ...
%1,-2.220446e-016,0,1.683829e+000,1.867367e+000,2.526645e+000,9.657433e-001,4.190446e+000,-3.562042e+000,3.068371e+000,-2.347105e-001,5.551115e-017,1.000000e+000,-2.775558e-017,-7.464751e-002,6.799817e-001,2.757651e-001,2.381709e-001,-7.124794e-001,-5.129215e-001,1.700450e+000,3.800039e-001,2.081668e-017,-4.163336e-017,1.000000e+000,1.038258e+000,7.317671e-001,1.787352e+000,7.363980e-001,1.622055e+000,2.238526e-001,1.574469e+000,1.054842e-001,...
%1,0,1.665335e-016,-5.551115e-017,-1.846184e+000,-4.226596e-001,1.046286e+000,5.733602e-001,-1.354636e+000,-2.399428e+000,4.926762e-001,5.551115e-017,1,-5.551115e-017,5.551115e-017,-4.698354e-001,6.861477e-001,7.511865e-001,-1.044439e+000,2.405097e-001,1.149708e+000,6.362102e-001,-3.885781e-016,-2.220446e-016,1.000000e+000,-1.110223e-016,-4.029360e+000,-6.764802e-001,1.793896e+000,-4.826270e-001,-6.492333e-001,-5.936455e+000,4.060089e-001,3.330669e-016,1.110223e-016,-2.220446e-016,1,3.137431e+000,1.899944e+000,-5.545638e-001,1.314717e+000,8.793314e-001,4.399340e+000,-3.809076e-001], ...
%11, 10) 
%temp = [1, -1.280261e+00,1.520068e+00,-2.136941e+00,-2.413439e+00,-1.043282e+00]; %betahat(:, 1, 1)%[1, 1.048517e+00,-1.468761e-01,5.176546e-01,-6.932168e-01,1.038724e+00];%[1, 1.11803278688525, -0.%139959016393443, 0.531762295081967, -0.80983606557377, 0.995491803278688];%[1, 1.048517e+00,-1.468761e-01,5.176546e-01,-%6.932168e-01,1.038724e+00];%betahat0(:, 1); %betahat0%

%temp = repmat(temp, 1, 10);
%temp = reshape(temp, p, 10);
%betapre = temp;

%betapre = reshape([1,-1.087745e+00,-5.655395e-01,1.284055e+00,8.623448e-01,6.120374e-01,2.077037e+00,-8.158886e-01,2.527340e-01,-3.989683e+00,5.289325e-01, 1,5.551115e-17,-6.343586e-01,-1.222266e-01,-1.353496e-01,1.806488e-01,1.138130e+00,5.641153e-01,5.735809e-01,-1.655472e+00,3.057801e-01,0,1,-6.326773e-02,-1.292841e+00,-9.172139e-01,-3.965900e-01,-8.631692e-01,1.268684e+00,2.949653e-01,2.145919e+00,-2.051515e-01,1,0,0,3.141054e-01,9.279429e-02,9.216725e-01,1.183568e+00,2.661065e-01,6.051084e-01,-3.075210e+00,3.311171e-01,-8.847090e-17,1.000000e+00,1.942890e-16,-1.249324e+00,-8.944599e-01,-3.226840e-01,-8.586374e-01,1.238962e+00,2.981097e-01,2.004321e+00,-2.026245e-01,5.551115e-17,-1.110223e-16,1.000000e+00,6.878318e-01,3.596450e-01,1.168146e+00,7.162801e-02,-4.697796e-01,4.969984e-02,-2.238069e+00,3.994113e-02, 1,1.179612e-16,2.775558e-17,-1.179612e-16,-1.282732e-02,4.208860e-01,1.077115e+00,5.173243e-01,3.017282e-01,-2.029289e+00,2.917150e-01,0,1,0,-8.326673e-17,-4.743602e-01,1.669146e+00,-4.352341e-01,2.397673e-01,1.504775e+00,-2.155728e+00,-4.590625e-02,5.551115e-17,2.775558e-17,1,6.938894e-17,1.283535e-01,7.151800e-02,-1.614824e-01,8.034022e-02,-6.146458e-01,5.230170e-02,-4.634217e-02,-5.551115e-17,-5.551115e-17,0,1,3.362617e-01,1.594326e+00,3.389060e-01,-7.997883e-01,9.658548e-01,-3.329841e+00,1.254424e-01], 11, 10)
%temp = otherresult.betahat(:, :, 3)
1, -1.280261e+00,1.520068e+00,-2.136941e+00,-2.413439e+00,-1.043282e+00%betapre= temp;%otherresult.betahat(:, :, 2); %[1,6.883514e-02,-1.962423e+00,-8.358984e-01,1.832206e+00,4.122993e+00,-1.066608e-01,3.763769e-01,9.957299e-01,4.582799e+00];% [1,2.407496e-01,4.041924e+00,-4.518882e-01,-3.065609e+00,-4.696349e+00,6.311301e-01,-8.134575e-01,-2.774575e-01,-1.157208e+01]'  %otherresult.betahat(:, :, 1);% [1,-1.1912,0.3264, -1.5492,0.8809, 0.5306]'[]';%
for i= 1:4

    if i==1
		temp = betahat0; %[1, -1.280261e+00,1.520068e+00,-2.136941e+00,-2.413439e+00,-1.043282e+00]; % [1, 1.048517e+00,-1.468761e-01,5.176546e-01,-6.932168e-01,1.038724e+00]%[1,-3.502997e-01,4.603892e-01,-4.381476e-01,-8.099124e-01,-5.679981e-01];%; %betahat(:, 1, 1)%;%[1, 1.11803278688525, -0.%139959016393443, 0.531762295081967, -0.80983606557377, 0.995491803278688];%[1, 1.048517e+00,-1.468761e-01,5.176546e-01,-%6.932168e-01,1.038724e+00];%betahat0(:, 1); %betahat0%

temp = repmat(temp, 1, 10);
temp = reshape(temp, p, 10);
betapre = temp;
        [LICa,LICb,ee(i,:),eflag(i,:),dis(i,:),betahat(:,:,i),div(:,i), ...
        div1(:, :, i)]=select_main_SIR(z,y,dim,beta0,1, pini, betapre);
        LIC(i,:)=(LICa+LICb)/2+([1:dim]*p)*log(n)
%	mbeta(itr, :, i) = betahat(:, :, i)
    end
    if i==2
		temp =betahat0;%; %[1, 1.048517e+00,-1.468761e-01,5.176546e-01,-6.932168e-01,1.038724e+00];% [1,-3.502997e-01,4.603892e-01,-4.381476e-01,-8.099124e-01,-5.679981e-01];%[1, -1.280261e+00,1.520068e+00,-2.136941e+00,-2.413439e+00,-1.043282e+00]; %betahat(:, 1, 1)%[1, 1.048517e+00,-1.468761e-01,5.176546e-01,-6.932168e-01,1.038724e+00];%[1, 1.11803278688525, -0.%139959016393443, 0.531762295081967, -0.80983606557377, 0.995491803278688];%[1, 1.048517e+00,-1.468761e-01,5.176546e-01,-%6.932168e-01,1.038724e+00];%betahat0(:, 1); %betahat0%

temp = repmat(temp, 1, 10);
temp = reshape(temp, p, 10);
betapre = temp;
        [LICa,LICb,ee(i,:),eflag(i,:),dis(i,:),betahat(:,:,i),div(:,i), ...
        div1(:, :, i)]=select_main_SAVE(z,y,dim,beta0,1, pini, betapre);
        LIC(i,:)=(LICa+LICb)/2+([1:dim]*p)*log(n)
 %      mbeta(itr, :, i) = betahat(:, :, i)
    end
    if i==3
		temp =betahat0;%[1, -1.280261e+00,1.520068e+00,-2.136941e+00,-2.413439e+00,-1.043282e+00]; %[1, 1.048517e+00,-1.468761e-01,5.176546e-01,-6.932168e-01,1.038724e+00];%[1,-3.502997e-01,4.603892e-01,-4.381476e-01,-8.099124e-01,-5.679981e-01];%[1, -1.280261e+00,1.520068e+00,-2.136941e+00,-2.413439e+00,-1.043282e+00]; %betahat(:, 1, 1)%[1, 1.048517e+00,-1.468761e-01,5.176546e-01,-6.932168e-01,1.038724e+00];%[1, 1.11803278688525, -0.%139959016393443, 0.531762295081967, -0.80983606557377, 0.995491803278688];%[1, 1.048517e+00,-1.468761e-01,5.176546e-01,-%6.932168e-01,1.038724e+00];%betahat0(:, 1); %betahat0%

temp = repmat(temp, 1, 10);
temp = reshape(temp, p, 10);
betapre = temp;
	[LICa,LICb,ee(i,:),eflag(i,:),dis(i,:),betahat(:,:,i),div(:,i), ...
        div1(:, :, i)]=select_main_DR(z,y,dim,beta0,1, pini, betapre);
        LIC(i,:)=(LICa+LICb)/2+([1:dim]*p)*log(n)
  %    mbeta(itr, :, i) = betahat(:, :, i)
    end
    if i==4
		temp =betahat0; %otherresult.betahat(:, 1, 1);%[1, -1.280261e+00,1.520068e+00,-2.136941e+00,-2.413439e+00,-1.043282e+00]; %[1, 1.048517e+00,-1.468761e-01,5.176546e-01,-6.932168e-01,1.038724e+00];% [1,-3.502997e-01,4.603892e-01,-4.381476e-01,-8.099124e-01,-5.679981e-01];%[1, -1.280261e+00,1.520068e+00,-2.136941e+00,-2.413439e+00,-1.043282e+00]; %betahat(:, 1, 1)%[1, 1.048517e+00,-1.468761e-01,5.176546e-01,-6.932168e-01,1.038724e+00];%[1, 1.11803278688525, -0.%139959016393443, 0.531762295081967, -0.80983606557377, 0.995491803278688];%[1, 1.048517e+00,-1.468761e-01,5.176546e-01,-%6.932168e-01,1.038724e+00];%betahat0(:, 1); %betahat0%

temp = repmat(temp, 1, 10);
temp = reshape(temp, p, 10);
betapre = temp;
        [LICa,LICb,ee(i,:),eflag(i,:),dis(i,:),betahat(:,:,i),div(:,i), ...
        div1(:, :, i)]=select_main_PHD(z,y,dim,beta0,1, pini, betapre);
        LIC(i,:)=(LICa+LICb)/2+([1:dim]*p)*log(n)
   %    mbeta(itr, :, i) = betahat(:, :, i)
    end
    i
end
div
		otherresult(itr) = struct('LIC', LIC, 'ee', ee, 'eflag', eflag, 'dis', ...
                     dis, 'betahat', betahat, 'div1', div1, 'div', div);       
		mx0(:, :, itr) = x0;
		my0(:,  itr) = y0;
		mnewx(:, :, itr) = newx;
		mnewy(:,  itr) = newy;

    
%save(sprintf('app_result_3_mave.mat'), 'otherresult'); 
%save(sprintf('betahat0.mat'), 'betahat0'); 


end
%save(sprintf('app_3_10_cross.mat'), 'cross'); 
		allOneString = sprintf('%d,' , otherresult(itr).betahat(:, 1, 2))
		
